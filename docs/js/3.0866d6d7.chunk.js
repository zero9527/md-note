(this["webpackJsonpmd-note"]=this["webpackJsonpmd-note"]||[]).push([[3],{85:function(e,t,n){e.exports={"note-detail":"styles_note-detail__A1Xhj","article-404":"styles_article-404__9jkpq",header:"styles_header__1o7G2",title:"styles_title__GgtK4",back:"styles_back__9_d1y"}},88:function(e,t,n){e.exports={"md-container":"styles_md-container__3fIh7","md-content":"styles_md-content__1BZgI","md-detail":"styles_md-detail__3E1ZT","md-preview":"styles_md-preview__eyAuJ",drag:"styles_drag__2fE19"}},89:function(e,t,n){e.exports={"pic-preview":"styles_pic-preview___6dgh",content:"styles_content__mGjqF",close:"styles_close__3QtS_",loading:"styles_loading__3N7qD","img-content":"styles_img-content__34pOG",text:"styles_text__GGazT"}},90:function(e,t,n){e.exports={catalog:"styles_catalog__hhxic",bg:"styles_bg__3QQdk",catelist:"styles_catelist__1RfRZ",close:"styles_close__21oXG",head:"styles_head__2fJ2w",desc:"styles_desc__1_ac3","cate-content":"styles_cate-content__Mg1oD","cate-item":"styles_cate-item__2jpto",active:"styles_active__I10Pt","cate-show":"styles_cate-show__23hX9"}},93:function(e,t,n){"use strict";n.r(t);var a=n(64),c=n.n(a),o=n(65),l=n(15),r=n(14),s=n(0),i=n.n(s),u=n(3),d=n(61),m=n(62),f=n(58),v=n(68),p=n(59),h=n(7),b=n(66),g=n(69),_=n(67),E=n(86),y=n.n(E),O=n(56),j=n.n(O),w=(n(87),n(60)),N=function(e){var t=e.className,n=void 0===t?"":t,a=e.onPosChange,c=(Object(w.a)(e,["className","onPosChange"]),Object(s.useRef)()),o=Object(s.useState)({posX:0,posY:0,posRight:10,posBottom:80}),u=Object(r.a)(o,2),d=u[0],m=u[1];Object(s.useEffect)((function(){return f(),function(){var e,t;null===(e=c.current)||void 0===e||e.removeEventListener("touchstart",v,{passive:!1}),null===(t=c.current)||void 0===t||t.removeEventListener("touchmove",p,{passive:!1})}}));var f=function(){var e,t;c.current=document.querySelector(".".concat(n)),null===(e=c.current)||void 0===e||e.addEventListener("touchstart",v,{passive:!1}),null===(t=c.current)||void 0===t||t.addEventListener("touchmove",p,{passive:!1})},v=function(e){e.preventDefault(),e.stopPropagation();var t=e.touches[0],n=t.pageX,a=t.pageY;m(Object(l.a)({},d,{posX:n,posY:a}))},p=function(e){e.preventDefault(),e.stopPropagation(),h(e)},h=function(e){var t=d.posX,n=d.posY,c=d.posRight,o=d.posBottom,l=e.touches[0],r=l.pageX,s=l.pageY,i=0,u=0;r>20&&r<window.innerWidth-20&&(i=r-t<0?c+Math.abs(r-t):c-Math.abs(r-t)),s>20&&s<window.innerHeight-20&&(u=s-n<0?o+Math.abs(s-n):o-Math.abs(s-n)),(r<=20||r>=window.innerWidth-20)&&(i=c),(s<=20||s>=window.innerHeight-20)&&(u=o),u=Math.round(u),i=Math.round(i),m({posX:r,posY:s,posBottom:u,posRight:i}),a({posBottom:u,posRight:i})};return i.a.createElement("div",{className:"btn ".concat(n)})},k=n(88),x=n.n(k),S=i.a.memo((function(e){var t=e.isEdit,n=e.mdtext,a=e.className,c=e.scrollTopRate,o=e.onMdRendered,l=Object(s.useRef)(),u=Object(s.useState)(!0),d=Object(r.a)(u,2),m=d[0],f=d[1],v=Object(s.useState)({posBottom:50,posRight:10}),p=Object(r.a)(v,2),h=p[0],b=p[1];Object(s.useEffect)((function(){c&&(l.current=document.querySelector(".".concat(x.a["md-content"])),l.current&&(l.current.scrollTop=l.current.scrollHeight*c))}),[c]);var g=function(e,t){var n=j.a.getLanguage(t)?t:"plaintext";return j.a.highlight(n,e,!0).value},_=Object(s.useMemo)((function(){return"container ".concat(x.a["md-container"]," ").concat(t?x.a["md-preview"]:x.a["md-detail"]," ").concat(a||"")}),[t,a]),E=Object(s.useMemo)((function(){var e="".concat(h.posBottom,"px"),n="".concat(h.posRight,"px");return t?{marginBottom:e,marginRight:n}:{}}),[t,h.posBottom,h.posRight]);return i.a.createElement("div",{className:_,style:E},t&&m&&i.a.createElement(N,{className:x.a.drag,onPosChange:function(e){var t=e.posBottom,n=e.posRight;b({posBottom:t,posRight:n})}}),(!t||m)&&i.a.createElement("section",{"data-text":t&&"\u9884\u89c8",className:x.a["md-content"],id:"md-content",dangerouslySetInnerHTML:{__html:y()(n,(function(){var e=new y.a.Renderer;e.heading=function(e,t){return"<h".concat(t,' class="heading-h').concat(t,'" id="').concat(e,'" title="').concat(e,'"><span>').concat(e,"</span></h").concat(t,">")},e.code=function(e,t){return'<pre>\n        <div class="languange">'.concat(t,'</div>\n        <div class="code-wrapper"><code class="').concat(t,'">').concat(g(e,t),"</code></div>\n      </pre>")},e.link=function(e,t,n){return'<a href="'.concat(e,'" class="link" title="').concat(t,'" target="_blank">').concat(n,'\n      <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="external-link-alt" class="svg-inline--fa fa-external-link-alt fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n      <path fill="currentColor" d="M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z">\n      </path></svg>\n      </a>')},e.image=function(e,t){return'<img src="'.concat(e,'" alt="').concat(t||"",'" class="md-img" />')},y.a.setOptions({renderer:e,highlight:g,langPrefix:"",pedantic:!1,gfm:!0,tables:!0,breaks:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1})}(),void(null===o||void 0===o||o())))}}),t&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{textAlign:"right"}},i.a.createElement("button",{className:"btn",onClick:function(){f(!m)}},m?"\u5173\u95ed\u9884\u89c8":"\u663e\u793a\u9884\u89c8"))))}),(function(e,t){return!t.isEdit||!Object.keys(t).some((function(n){return t[n]!==e[n]}))})),B=n(91),R=n(90),C=n.n(R),L=function(e){var t=e.mdtext,n=e.defaultActive,a=e.onCateClick,c=e.onGetTitle,o=Object(w.a)(e,["mdtext","defaultActive","onCateClick","onGetTitle"]),l=Object(p.a)(),u=l.scrollTop,f=l.prevScrollTop,v=Object(s.useRef)(!0),h=Object(s.useState)(!1),b=Object(r.a)(h,2),g=b[0],_=b[1],E=Object(s.useState)([]),y=Object(r.a)(E,2),O=y[0],j=y[1],N=Object(s.useState)(""),k=Object(r.a)(N,2),x=k[0],S=k[1],R=Object(s.useState)(""),L=Object(r.a)(R,2),T=L[0],I=L[1],M=Object(s.useState)([]),A=Object(r.a)(M,2),H=A[0],Y=A[1];Object(s.useEffect)((function(){T&&(document.title="MD-NOTE|".concat(T),null===c||void 0===c||c(T))}),[T]),Object(s.useEffect)((function(){P(),n&&S(n)}),[]),Object(s.useEffect)((function(){document.body.style.overflowY=g?"hidden":"auto"}),[g]),Object(s.useEffect)((function(){Y(function e(t){var n=[];return t.forEach((function(t){var a;(null===t||void 0===t||null===(a=t.child)||void 0===a?void 0:a.length)?n.push.apply(n,[t].concat(Object(B.a)(e(t.child)))):n.push(t)})),n}(O))}),[O]),Object(s.useEffect)((function(){v.current&&setTimeout(G,0)}),[u]);var G=function(){try{var e=H.reverse().find((function(e){var t=document.getElementById(e.id),n=null===t||void 0===t?void 0:t.getBoundingClientRect();return(null===n||void 0===n?void 0:n.top)<20&&(null===n||void 0===n?void 0:n.bottom)>0}));e&&(S(e.id),X(e))}catch(t){console.error(t)}},P=function(){var e=[],n=[],a=t.slice(t.indexOf("\n"),t.length);I(t.slice(2,t.indexOf("\n"))),a.split("\n## ").forEach((function(t){var a=t.substring(0,t.indexOf("\n")).trim(),c=t.split("\n### ");c.shift();var o=[];c.forEach((function(e){var t=e.substring(0,e.indexOf("\n")).trim();o.push({id:t,header:"catelog-".concat(t),label:t})}));var l={id:a,header:"catelog-".concat(a),label:a,child:[]};e.push(a),o.length>0&&(l.child=o,e=e.concat(o.map((function(e){return e.id})))),n.push(l)})),j((function(){return n.filter((function(e){return Boolean(e.id)}))}))},X=function(e){var t=document.getElementById("catelog-".concat(e.id));null===t||void 0===t||t.scrollIntoView(),null===a||void 0===a||a(e.id)},q=function(e){var t;null===(t=document.querySelector("#md-note"))||void 0===t||t.classList[e]("blur")},V=Object(s.useCallback)((function(e,t){var n="".concat(C.a["cate-item"]," ").concat(x===e.id?C.a.active:"");return i.a.createElement("li",{key:"".concat(e.id,"-").concat(t),"data-id":e.id,id:e.header,title:e.id,className:n,onClick:function(){return function(e){var t=document.getElementById(e.id);null===t||void 0===t||t.scrollIntoView(),v.current=!1,q("remove"),S(e.id),null===a||void 0===a||a(e.id),setTimeout((function(){_(!1),v.current=!0}),0)}(e)}},e.label)}),[x]),D=Object(s.useMemo)((function(){return g?C.a["cate-show"]:""}),[g]);return i.a.createElement("div",{id:"catalog",className:C.a.catalog},i.a.createElement(d.a,{className:"btn",icon:m.d,onClick:function(){q("add"),setTimeout((function(){return _(!0)}),0)}}),i.a.createElement("div",{className:C.a.bg,style:{display:g?"block":"none"}}),i.a.createElement("div",{style:{marginTop:u>50&&u>f?"0":""},className:"".concat(C.a.catelist," ").concat(D)},g&&i.a.createElement("span",{className:C.a.close,onClick:function(){_(!1),q("remove")}},i.a.createElement(d.a,{icon:m.c})),i.a.createElement("section",{className:C.a.head,title:T},"\u76ee\u5f55: ",T),i.a.createElement("section",{className:C.a["cate-content"]},O.length>0?O.map((function(e,t){var n,a;return i.a.createElement("ul",{key:e.id},V(e,t),e.child&&(null===(n=e.child)||void 0===n?void 0:n.length)>0&&i.a.createElement("ul",null,null===(a=e.child)||void 0===a?void 0:a.map((function(e,t){return V(e,t)}))))})):i.a.createElement((function(){return i.a.createElement("div",{className:C.a.desc},i.a.createElement("p",null,"\u4e00\u7ea7\u6807\u9898'#'\u4e3a\u6587\u7ae0\u540d\uff0c"),i.a.createElement("p",null,"\u4e8c\u7ea7\u6807\u9898'##'\u4e3a\u4e00\u7ea7\u76ee\u5f55\uff0c"),i.a.createElement("p",null,"\u4e09\u7ea7\u6807\u9898'###'\u4e3a\u4e09\u7ea7\u76ee\u5f55"))}),null))),o.children)},T=n(9),I=n.n(T),M=n(89),A=n.n(M),H=function(e){var t=e.show,n=e.src,a=e.alt,c=e.onClose;return Object(s.useEffect)((function(){var e=document.querySelector("#md-note"),n=document.querySelector("#catalog");return t?(e.classList.add("blur"),n.classList.add("blur"),document.body.style.overflowY="hidden"):(e.classList.remove("blur"),n.classList.remove("blur"),document.body.style.overflowY=""),function(){e.classList.remove("blur"),n.classList.remove("blur"),document.body.style.overflowY=""}}),[t]),I.a.createPortal(i.a.createElement(i.a.Fragment,null,t&&i.a.createElement("section",{className:A.a["pic-preview"]},i.a.createElement("div",{className:A.a.content},i.a.createElement("button",{className:"btn ".concat(A.a.close),onClick:c},"X"),i.a.createElement("div",{className:A.a["img-content"]},n?i.a.createElement("img",{src:n,alt:a}):i.a.createElement("span",{className:A.a.loading},"\u6b63\u5728\u751f\u6210\u622a\u56fe\u3002\u3002\u3002")),i.a.createElement("div",{className:A.a.text},"\u5bfc\u51fa\u56fe\u7247\u9884\u89c8\uff0c\u53f3\u952e\u53e6\u5b58/\u957f\u6309\u4fdd\u5b58\uff01")))),document.body)},Y=n(85),G=n.n(Y);t.default=function(){var e=Object(f.a)((function(e){return[e.stickyRightStyle]})).stickyRightStyle,t=Object(v.a)((function(e){return[e.getNoteById,e.updateNoteById,e.fetchNoteByName]})),n=t.getNoteById,a=t.updateNoteById,E=t.fetchNoteByName,y=Object(u.useParams)(),O=y.tag,j=y.name,w=Object(u.useHistory)(),N=Object(u.useLocation)(),k=Object(p.a)().scrollTop,x=Object(s.useState)(!1),B=Object(r.a)(x,2),R=B[0],C=B[1],T=Object(s.useState)(""),I=Object(r.a)(T,2),M=I[0],A=I[1],Y=Object(s.useState)(),P=Object(r.a)(Y,2),X=P[0],q=P[1],V=Object(s.useState)(!1),D=Object(r.a)(V,2),F=D[0],Z=D[1],J=Object(s.useState)(),Q=Object(r.a)(J,2),z=Q[0],W=Q[1],K=Object(s.useState)({show:!1,src:"",alt:"",onClose:function(){ee((function(e){return Object(l.a)({},e,{show:!1})}))}}),U=Object(r.a)(K,2),$=U[0],ee=U[1];Object(s.useEffect)((function(){te()}),[]),Object(s.useEffect)((function(){ce()}),[k]);var te=function(){var e=Object(o.a)(c.a.mark((function e(){var t,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=n(j))||void 0===t?void 0:t.data)){e.next=4;break}return q(t.data),e.abrupt("return");case 4:return e.prev=4,e.next=7,E(O,j);case 7:if(0!==(null===(o=e.sent)||void 0===o?void 0:o.code)){e.next=15;break}if(!o.data.substring(0,20).includes("<!DOCTYPE html>")){e.next=11;break}return e.abrupt("return");case 11:a(j,o.data),q(o.data),e.next=18;break;case 15:console.log("\u6570\u636e\u6ca1\u6709\u4e86\uff01"),q(""),C(!0);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),console.error(e.t0);case 23:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=document.querySelectorAll("#md-note .md-img");Array.from(e).forEach((function(e){e.onclick=function(){window.open(e.src)}}))},ae=function(e){if(e){var t=document.getElementById(e);null===t||void 0===t||t.scrollIntoView(),W(e)}},ce=function(){Z((function(){return k>window.innerHeight}))};return i.a.createElement(i.a.Fragment,null,i.a.createElement(b.a,{className:G.a.header},i.a.createElement("div",{className:"center-content"},i.a.createElement(d.a,{icon:m.b,className:G.a.back,title:"\u8fd4\u56de\u9996\u9875",onClick:function(){w.push("/")}}),i.a.createElement("span",{className:G.a.title,title:"\u6587\u7ae0\u6807\u9898"},"\xa0",M))),i.a.createElement("main",{className:"center-content ".concat(G.a["note-detail"])},X?i.a.createElement(i.a.Fragment,null,i.a.createElement(S,{mdtext:X,onMdRendered:function(){var e=N.hash.substr(1,N.hash.length);setTimeout((function(){ae(decodeURI(e)),ne()}),0)}}),i.a.createElement(H,$),i.a.createElement(_.a,null,i.a.createElement(L,{mdtext:X,defaultActive:z,onCateClick:function(e){w.replace({pathname:N.pathname,hash:e})},onGetTitle:function(e){A(e)}}))):!R&&i.a.createElement(h.a,null),R&&i.a.createElement((function(){return i.a.createElement("div",{className:G.a["article-404"]},"\u6587\u7ae0\u4e0d\u89c1\u4e86\u3002\u3002\u3002")}),null),F&&i.a.createElement(g.a,{position:e})))}}}]);